

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>The Beautiful Einstein Summations &mdash; CR.Vision  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/js/mathconf.js"></script>
        <script src="../../_static/js/custom.js"></script>
        <script src="../../_static/js/disqus.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="References" href="../../zzzreferences.html" />
    <link rel="prev" title="Linear Algebra Computations" href="index.html" />
 
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
    Macros: {
        // All bold letters
        AA: '{\\mathbb{A}}',
        BB: '{\\mathbb{B}}',
        // Complex space symbol
        CC: '{\\mathbb{C}}',
        // A dictionary
        DD: '{\\mathbb{D}}',
        // Expectation operator
        EE: '{\\mathbb{E}}',
        // A field
        FF: '{\\mathbb{F}}',
        // A group
        GG: '{\\mathbb{G}}',
        // A Hilbert space
        HH: '{\\mathbb{H}}',
        // Irrational numbers
        II: '{\\mathbb{I}}',
        JJ: '{\\mathbb{J}}',
        // Real or complex space symbol
        KK: '{\\mathbb{K}}',
        // Natural numbers
        NN: '{\\mathbb{N}}',
        Nat: '{\\mathbb{N}}',
        // Probability set symbol
        PP: '{\\mathbb{P}}',
        // Rational numbers
        QQ: '{\\mathbb{Q}}',
        // Real line symbol
        RR: '{\\mathbb{R}}',
        RRMN: '{\\mathbb{R}^{M \\times N} }',
        // A linear operator
        TT: '{\\mathbb{T}}',
        // Another linear operator
        UU: '{\\mathbb{U}}',
        // A vector space
        VV: '{\\mathbb{V}}',
        // A subspace
        WW: '{\\mathbb{W}}',
        // An inner product space
        XX: '{\\mathbb{X}}',
        // Integers
        ZZ: '{\\mathbb{Z}}',

        // All mathcal shortcuts
        AAA: '{\\mathcal{A}}',
        BBB: '{\\mathcal{B}}',
        CCC: '{\\mathcal{C}}',
        DDD: '{\\mathcal{D}}',
        EEE: '{\\mathcal{E}}',
        FFF: '{\\mathcal{F}}',
        GGG: '{\\mathcal{G}}',
        HHH: '{\\mathcal{H}}',
        III: '{\\mathcal{I}}',
        JJJ: '{\\mathcal{J}}',
        KKK: '{\\mathcal{K}}',
        LLL: '{\\mathcal{L}}',
        MMM: '{\\mathcal{M}}',
        NNN: '{\\mathcal{N}}',
        OOO: '{\\mathcal{O}}',
        PPP: '{\\mathcal{P}}',
        QQQ: '{\\mathcal{Q}}',
        RRR: '{\\mathcal{R}}',
        SSS: '{\\mathcal{S}}',
        TTT: '{\\mathcal{T}}',
        UUU: '{\\mathcal{U}}',
        VVV: '{\\mathcal{V}}',
        WWW: '{\\mathcal{W}}',
        XXX: '{\\mathcal{X}}',
        YYY: '{\\mathcal{Y}}',
        ZZZ: '{\\mathcal{Z}}',

        Tau: '{\\mathcal{T}}',
        Chi: '{\\mathcal{X}}',
        Eta: '{\\mathcal{H}}',

        // Real part of a complex number
        Re: '\\operatorname{Re}',
        Im: '\\operatorname{Im}',


        // Null space
        NullSpace: '{\\mathcal{N}}',
        // Column space
        ColSpace: '{\\mathcal{C}}',
        // Row space
        RowSpace: '{\\mathcal{R}}',
        // Power set
        Power: '{\\mathop{\\mathcal{P}}}',
        LinTSpace:'{\\mathcal{L}}', 

        // Range
        Range: '{\\mathrm{R}}',
        // image
        Image: '{\\mathrm{im}}',
        // Kernel
        Kernel: '{\\mathrm{ker}}',
        // Span
        Span: '{\\mathrm{span}}',
        // Nullity of an operator
        Nullity: '{\\mathrm{nullity}}',
        // Dimension of a vector space
        Dim: '{\\mathrm{dim}}',
        // Rank of a matrix
        Rank: '{\\mathrm{rank}}',
        // Trace of a matrix
        Trace: '{\\mathrm{tr}}',
        // Diagonal of a matrix
        Diag: '{\\mathrm{diag}}',
        // Signum function
        sgn: '{\\mathrm{sgn}}',
        // Support function
        supp: '{\\mathrm{supp}}',
        // Row support
        rowsupp: '{\\mathop{\\mathrm{rowsupp}}}',
        // Entry wise absolute value function
        abs: '{\\mathop{\\mathrm{abs}}}',
        // error function
        erf: '{\\mathop{\\mathrm{erf}}}',
        // complementary error function
        erfc: '{\\mathop{\\mathrm{erfc}}}',
        // Sub Gaussian function
        Sub: '{\\mathop{\\mathrm{Sub}}}',
        // Strictly sub Gaussian function
        SSub: '{\\mathop{\\mathrm{SSub}}}',
        // Variance function
        Var: '{\\mathop{\\mathrm{Var}}}',
        // Covariance matrix
        Cov: '{\\mathop{\\mathrm{Cov}}}',
        // Affine hull of a set
        AffineHull: '{\\mathop{\\mathrm{aff}}}',
        // Convex hull of a set
        ConvexHull: '{\\mathop{\\mathrm{conv}}}',

        // Set theory related stuff
        argmin:'\\mathrm{arg}\\,\\mathrm{min}',
        argmax:'\\mathrm{arg}\\,\\mathrm{max}',
        EmptySet:'\\varnothing',
        // Forall operator with some space
        Forall: '\\; \\forall \\;',

        // Probability distributions
        Gaussian: '{\\mathcal{N}}',


        // Sparse representations related stuff
        // Spark of a matrix
        spark: '{\\mathop{\\mathrm{spark}}}',
        // Exact Recovery Criterion
        ERC: '{\\mathop{\\mathrm{ERC}}}',
        // Maximum correlation
        Maxcor: '{\\mathop{\\mathrm{maxcor}}}',
        BPhi: '\\mathbf{\\Phi}',
        BPsi: '\\mathbf{\\Psi}',

        // pseudo-inverse
        dag: '\\dagger',
        // bracket operator
        Bracket: '\\left [ \\; \\right ]',
        // OneVec
        OneVec: '\\mathbb{1}',
        ZeroVec: '0',
        OneMat: '\\mathbf{1}',
    }
  }
});
console.log(6);
</script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> CR.Vision
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nb_basic_image_operations.html">Basic Image Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../image_processing/index.html">Image Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cnn/index.html">Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../srrcs/index.html">Sparse Representations and Compressive Sensing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Notes on Scientific Computing</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Linear Algebra Computations</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">The Beautiful Einstein Summations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#einstein-notation">Einstein Notation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#einsum"><code class="docutils literal notranslate"><span class="pre">einsum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#vector-operations">Vector Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#matrix-operations">Matrix Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#general-array-operations">General Array Operations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../zzzreferences.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/cr.vision.html">cr.vision package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CR.Vision</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Notes on Scientific Computing</a> &raquo;</li>
        
          <li><a href="index.html">Linear Algebra Computations</a> &raquo;</li>
        
      <li>The Beautiful Einstein Summations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/notes/la/einsum.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="the-beautiful-einstein-summations">
<h1>The Beautiful Einstein Summations<a class="headerlink" href="#the-beautiful-einstein-summations" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#einstein-notation" id="id2">Einstein Notation</a></p></li>
<li><p><a class="reference internal" href="#einsum" id="id3"><code class="docutils literal notranslate"><span class="pre">einsum</span></code></a></p></li>
<li><p><a class="reference internal" href="#vector-operations" id="id4">Vector Operations</a></p>
<ul>
<li><p><a class="reference internal" href="#sum-of-all-elements-of-a-vector" id="id5">Sum of all elements of a vector</a></p></li>
<li><p><a class="reference internal" href="#element-wise-multiplication" id="id6">Element wise multiplication</a></p></li>
<li><p><a class="reference internal" href="#inner-product" id="id7">Inner Product</a></p></li>
<li><p><a class="reference internal" href="#outer-product" id="id8">Outer Product</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#matrix-operations" id="id9">Matrix Operations</a></p>
<ul>
<li><p><a class="reference internal" href="#matrix-transpose" id="id10">Matrix Transpose</a></p></li>
<li><p><a class="reference internal" href="#main-diagonal" id="id11">Main Diagonal</a></p></li>
<li><p><a class="reference internal" href="#trace" id="id12">Trace</a></p></li>
<li><p><a class="reference internal" href="#sum-of-elements" id="id13">Sum of Elements</a></p></li>
<li><p><a class="reference internal" href="#column-wise-sum" id="id14">Column-wise Sum</a></p></li>
<li><p><a class="reference internal" href="#row-wise-sum" id="id15">Row-wise Sum</a></p></li>
<li><p><a class="reference internal" href="#matrix-multiplication" id="id16">Matrix Multiplication</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id17">Element-wise Multiplication</a></p></li>
<li><p><a class="reference internal" href="#column-wise-dot-product" id="id18">Column-wise Dot Product</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#general-array-operations" id="id19">General Array Operations</a></p></li>
</ul>
</div>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Einstein_notation">Einstein summations</a>
are a powerful mechanism for array operations.
Major scientific computing / neural network
libraries like
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.einsum.html">numpy</a>,
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/einsum">TensorFlow</a>,
and <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.einsum.html">PyTorch</a> have built in support for
performing linear algebraic array operations using Einstein
summation convention.
This article is a gentle introduction on using
Einstein summations for such operations. The libraries
have highly efficient implementations available for
computing Einstein summations and thus they would run
much faster than any hand written alternative code.</p>
<p class="rubric">Notation</p>
<p>Vectors will be denoted using small letters
<span class="math notranslate nohighlight">\(u, v, w, x, y, z\)</span>. Scalars will also be small letters
<span class="math notranslate nohighlight">\(a,b,c,m,n,s\)</span> etc.
The letters <span class="math notranslate nohighlight">\(i,j,k,l\)</span> will be used to indicate indices.
Matrices will be denoted with capital letters <span class="math notranslate nohighlight">\(A,B,C\)</span>
etc.</p>
<p>Elements of a vector will be denoted using <code class="docutils literal notranslate"><span class="pre">numpy</span></code>
notation <span class="math notranslate nohighlight">\(v[i]\)</span>.
Elements, rows and columns of a matrix will also be denoted
using <code class="docutils literal notranslate"><span class="pre">numpy</span></code> notation <span class="math notranslate nohighlight">\(A[i,j]\)</span>,
<span class="math notranslate nohighlight">\(A[i,:]\)</span> and <span class="math notranslate nohighlight">\(A[:, j]\)</span>.</p>
<div class="section" id="einstein-notation">
<h2><a class="toc-backref" href="#id2">Einstein Notation</a><a class="headerlink" href="#einstein-notation" title="Permalink to this headline">¶</a></h2>
<p>Consider a matrix multiplication operation <span class="math notranslate nohighlight">\(C = A B\)</span>.
Individual elements of <span class="math notranslate nohighlight">\(C\)</span> are computed by the summation:</p>
<div class="math notranslate nohighlight">
\[C[i, k] = \sum_{j} A[i, j] B [j, k]\]</div>
<p>Einstein notation simply drops the summations from the equation:</p>
<div class="math notranslate nohighlight">
\[C[i, k] = A[i, j] B [j, k]\]</div>
<p>The idea is simple. If an index doesn’t appear in the
L.H.S. but it appears in the R.H.S., then we assume that
the expression on the R.H.S. is to be summed over that
index. In the matrix multiplication example above, since
the index <span class="math notranslate nohighlight">\(j\)</span> appears on R.H.S. and doesn’t appear
on the L.H.S., we assume that the expression
<span class="math notranslate nohighlight">\(A[i, j] B [j, k]\)</span> is to be summed over <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>The equation <span class="math notranslate nohighlight">\(s = v[i]\)</span> would mean that we need
to sum over all the elements of a vector <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>The equation <span class="math notranslate nohighlight">\(s = A[i,j]\)</span> would mean that we
need to sum over all the elements of the matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>The equation <span class="math notranslate nohighlight">\(C[i, j] = A [i, j] B [i, j]\)</span> would
mean that we need to multiply <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> element-wise
to compute <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>The equation <span class="math notranslate nohighlight">\(v[i] = A[i, j]\)</span> would mean that each
element of the vector <span class="math notranslate nohighlight">\(v\)</span> is the sum of elements in
corresponding row of matrix <span class="math notranslate nohighlight">\(A\)</span>, i.e. row wise sum of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>In this article, we will explore Einstein summations
using <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
</div>
<div class="section" id="einsum">
<h2><a class="toc-backref" href="#id3"><code class="docutils literal notranslate"><span class="pre">einsum</span></code></a><a class="headerlink" href="#einsum" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">numpy.einsum</span></code> is a general purpose workhorse
function in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> for computing summations following
the Einstein Notation a.k.a. Einstein summations.
For example, the matrix multiplication <span class="math notranslate nohighlight">\(C = AB\)</span>
is computed as <code class="docutils literal notranslate"><span class="pre">einsum('ij,jk-&gt;ik',</span> <span class="pre">A,</span> <span class="pre">B)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The explanation may seem heavy in first go. Read it once,
read all the examples in following sections, come back,
and read this section again.</p>
</div>
<p>To understand this function, we need to understand
the subscripts specification in the first argument
<code class="docutils literal notranslate"><span class="pre">ij,jk-&gt;ik</span></code>. Let’s revisit the matrix multiplication equation:</p>
<div class="math notranslate nohighlight">
\[C[i, k] = A [i, j] B [j, k]\]</div>
<ul class="simple">
<li><p>There are two arguments to matrix multiplication: <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> is indexed by <span class="math notranslate nohighlight">\(i\)</span> (for rows) and <span class="math notranslate nohighlight">\(j\)</span> (for columns).</p></li>
<li><p><span class="math notranslate nohighlight">\(B\)</span> is indexed by <span class="math notranslate nohighlight">\(j\)</span> (for rows) and <span class="math notranslate nohighlight">\(k\)</span> (for columns).</p></li>
<li><p>The output of the operation is the matrix <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(C\)</span> is indexed by <span class="math notranslate nohighlight">\(i\)</span> (for rows) and <span class="math notranslate nohighlight">\(k\)</span> (for columns).</p></li>
</ul>
<p>Now let’s parse <code class="docutils literal notranslate"><span class="pre">ij,jk-&gt;ik</span></code>.</p>
<ul class="simple">
<li><p>The Einstein summation <code class="docutils literal notranslate"><span class="pre">einsum('ij,jk-&gt;ik',</span> <span class="pre">A,</span> <span class="pre">B)</span></code> has two arguments <span class="math notranslate nohighlight">\(A\)</span>
and <span class="math notranslate nohighlight">\(B\)</span>.</p></li>
<li><p>The specification <code class="docutils literal notranslate"><span class="pre">ij,jk-&gt;ik</span></code> describes how the summation is to proceed.</p></li>
<li><p>There are two parts: <code class="docutils literal notranslate"><span class="pre">ij,jk</span></code> and <code class="docutils literal notranslate"><span class="pre">ik</span></code> separated by <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code>. Input -&gt; Output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ik</span></code> are the indices for the output of the summation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ij,jk</span></code> are indices for the input arguments for the summation</p></li>
<li><p>The comma separates indices for different input arguments.
Thus, in this case, there are two arguments.</p></li>
<li><p>Splitting <code class="docutils literal notranslate"><span class="pre">ij,jk</span></code>, <code class="docutils literal notranslate"><span class="pre">ij</span></code> are indices for first argument <span class="math notranslate nohighlight">\(A\)</span> and
<code class="docutils literal notranslate"><span class="pre">jk</span></code> are indices for second argument <span class="math notranslate nohighlight">\(B\)</span>.</p></li>
<li><p>Since there are two letters for each argument, we assume that the
arguments are both two dimension arrays (i.e. matrices).</p></li>
<li><p>The first letter refers to the index for the rows of a matrix and the second
letter refers to the index for the columns of the same matrix.</p></li>
<li><p>Thus, it translates to <code class="docutils literal notranslate"><span class="pre">A[i,</span> <span class="pre">j]</span> <span class="pre">*</span> <span class="pre">B[j,</span> <span class="pre">k]</span></code> and the result is stored in
<code class="docutils literal notranslate"><span class="pre">C[i,k]</span></code>.</p></li>
</ul>
<p>We will now look at all kinds of linear algebraic array operations possible
via <code class="docutils literal notranslate"><span class="pre">einsum</span></code>.</p>
<p>Load the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> library first:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>In the examples below:</p>
<ul class="simple">
<li><p>We present the underlying mathematical equation first in Einstein notation
for each linear algebraic operation.</p></li>
<li><p>We then present its implementation using <code class="docutils literal notranslate"><span class="pre">einsum</span></code>.</p></li>
<li><p>We also contrast it with the standard <code class="docutils literal notranslate"><span class="pre">numpy</span></code> functions for same operation.</p></li>
</ul>
</div>
<div class="section" id="vector-operations">
<h2><a class="toc-backref" href="#id4">Vector Operations</a><a class="headerlink" href="#vector-operations" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(u, v\)</span> be a vectors of length <span class="math notranslate nohighlight">\(n=3\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="sum-of-all-elements-of-a-vector">
<h3><a class="toc-backref" href="#id5">Sum of all elements of a vector</a><a class="headerlink" href="#sum-of-all-elements-of-a-vector" title="Permalink to this headline">¶</a></h3>
<p>In normal mathematical notation, we say <span class="math notranslate nohighlight">\(s = \sum_{i=0}^{n-1} v[i]\)</span>.
In Einstein notation, we say <span class="math notranslate nohighlight">\(s = v[i]\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;i-&gt;&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;i-&gt;&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
</div>
<div class="section" id="element-wise-multiplication">
<h3><a class="toc-backref" href="#id6">Element wise multiplication</a><a class="headerlink" href="#element-wise-multiplication" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[w[i] = u[i] v[i]\]</div>
<p>In this case, there is no summation happening in the R.H.S.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;i,i-&gt;i&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span>
<span class="go">array([ 0,  2, 12])</span>
</pre></div>
</div>
</div>
<div class="section" id="inner-product">
<h3><a class="toc-backref" href="#id7">Inner Product</a><a class="headerlink" href="#inner-product" title="Permalink to this headline">¶</a></h3>
<p>Normal mathematical notation:</p>
<div class="math notranslate nohighlight">
\[s = \langle u, v \rangle = \sum_{i=0}^{n-1} u[i] v[i]\]</div>
<p>Einstein notation:</p>
<div class="math notranslate nohighlight">
\[s = \langle u, v \rangle = u[i] v[i]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;i,i-&gt;&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="go">14</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="go">14</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="go">14</span>
</pre></div>
</div>
</div>
<div class="section" id="outer-product">
<h3><a class="toc-backref" href="#id8">Outer Product</a><a class="headerlink" href="#outer-product" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[A[i,j] = u[i] v[j]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="go">array([[ 0,  0,  0],</span>
<span class="go">   [ 1,  2,  3],</span>
<span class="go">   [ 4,  8, 12]])</span>


<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,j-&gt;ij&#39;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="go">array([[ 0,  0,  0],</span>
<span class="go">   [ 1,  2,  3],</span>
<span class="go">   [ 4,  8, 12]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="matrix-operations">
<h2><a class="toc-backref" href="#id9">Matrix Operations</a><a class="headerlink" href="#matrix-operations" title="Permalink to this headline">¶</a></h2>
<p>Let’s construct 2 square matrices <span class="math notranslate nohighlight">\(A, B\)</span> for the examples below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">   [3, 4, 5],</span>
<span class="go">   [0, 1, 2]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span>
<span class="go">array([[-1,  1, -2],</span>
<span class="go">   [ 3,  2, -3],</span>
<span class="go">   [ 0, -1,  1]])</span>
</pre></div>
</div>
<div class="section" id="matrix-transpose">
<h3><a class="toc-backref" href="#id10">Matrix Transpose</a><a class="headerlink" href="#matrix-transpose" title="Permalink to this headline">¶</a></h3>
<p>The expression <span class="math notranslate nohighlight">\(C  = A^T\)</span> is computed as:</p>
<div class="math notranslate nohighlight">
\[C[j, i] = A [i, j]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij-&gt;ji&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">array([[0, 3, 0],</span>
<span class="go">   [1, 4, 1],</span>
<span class="go">   [2, 5, 2]])</span>

<span class="go">&gt;&gt; A.T</span>
<span class="go">array([[0, 3, 0],</span>
<span class="go">   [1, 4, 1],</span>
<span class="go">   [2, 5, 2]])</span>
</pre></div>
</div>
</div>
<div class="section" id="main-diagonal">
<h3><a class="toc-backref" href="#id11">Main Diagonal</a><a class="headerlink" href="#main-diagonal" title="Permalink to this headline">¶</a></h3>
<p>The main diagonal of a matrix <span class="math notranslate nohighlight">\(A\)</span> can be extracted as:</p>
<div class="math notranslate nohighlight">
\[v[i] = A[i,i]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ii-&gt;i&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">array([0, 4, 2])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">array([0, 4, 2])</span>
</pre></div>
</div>
</div>
<div class="section" id="trace">
<h3><a class="toc-backref" href="#id12">Trace</a><a class="headerlink" href="#trace" title="Permalink to this headline">¶</a></h3>
<p>The trace of a matrix is the sum of its diagonal elements.</p>
<div class="math notranslate nohighlight">
\[\text{Trace}(A) = \sum_{i} A[i, i]\]</div>
<p>In Einstein notation:</p>
<div class="math notranslate nohighlight">
\[\text{Trace}(A) = A[i, i]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ii-&gt;&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
</div>
<div class="section" id="sum-of-elements">
<h3><a class="toc-backref" href="#id13">Sum of Elements</a><a class="headerlink" href="#sum-of-elements" title="Permalink to this headline">¶</a></h3>
<p>The sum of all elements of a matrix can be expressed as
<span class="math notranslate nohighlight">\(\sum_{i} \sum_{j} A[i, j]\)</span>. In Einstein notation:</p>
<div class="math notranslate nohighlight">
\[s = A[i, j]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij-&gt;&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">18</span>
</pre></div>
</div>
</div>
<div class="section" id="column-wise-sum">
<h3><a class="toc-backref" href="#id14">Column-wise Sum</a><a class="headerlink" href="#column-wise-sum" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[v[j] = A[i, j]  = \sum_i A[i, j]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([3, 6, 9])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij-&gt;j&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">array([3, 6, 9])</span>
</pre></div>
</div>
</div>
<div class="section" id="row-wise-sum">
<h3><a class="toc-backref" href="#id15">Row-wise Sum</a><a class="headerlink" href="#row-wise-sum" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[v[i] = A[i, j] = \sum_j A[i, j]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([ 3, 12,  3])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij-&gt;i&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">array([ 3, 12,  3])</span>
</pre></div>
</div>
</div>
<div class="section" id="matrix-multiplication">
<h3><a class="toc-backref" href="#id16">Matrix Multiplication</a><a class="headerlink" href="#matrix-multiplication" title="Permalink to this headline">¶</a></h3>
<p>We can consider four possibilities:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(C = A B\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(C = A^T B\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(C = A B^T\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(C = A^T B^T = (BA)^T\)</span></p></li>
</ol>
<p class="rubric"><span class="math notranslate nohighlight">\(C = A B\)</span></p>
<div class="math notranslate nohighlight">
\[C[i, k] = A[i, j] B [j, k]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">@</span> <span class="n">B</span>
<span class="go">array([[  3,   0,  -1],</span>
<span class="go">   [  9,   6, -13],</span>
<span class="go">   [  3,   0,  -1]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,jk-&gt;ik&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">array([[  3,   0,  -1],</span>
<span class="go">   [  9,   6, -13],</span>
<span class="go">   [  3,   0,  -1]])</span>
</pre></div>
</div>
<p class="rubric"><span class="math notranslate nohighlight">\(C = A^T B\)</span></p>
<div class="math notranslate nohighlight">
\[C[i, k] = A[j, i] B [j, k]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">B</span>
<span class="go">array([[  9,   6,  -9],</span>
<span class="go">   [ 11,   8, -13],</span>
<span class="go">   [ 13,  10, -17]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ji,jk-&gt;ik&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">array([[  9,   6,  -9],</span>
<span class="go">   [ 11,   8, -13],</span>
<span class="go">   [ 13,  10, -17]])</span>
</pre></div>
</div>
<p class="rubric"><span class="math notranslate nohighlight">\(C = A B^T\)</span> (inner product)</p>
<div class="math notranslate nohighlight">
\[C[i, k] = A[i, j] B [k, j]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">@</span> <span class="n">B</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[-3, -4,  1],</span>
<span class="go">   [-9,  2,  1],</span>
<span class="go">   [-3, -4,  1]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,kj-&gt;ik&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">array([[-3, -4,  1],</span>
<span class="go">   [-9,  2,  1],</span>
<span class="go">   [-3, -4,  1]])</span>
</pre></div>
</div>
<p>This is also known as inner product of two matrices
in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> as <code class="docutils literal notranslate"><span class="pre">numpy</span></code> is row major.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">array([[-3, -4,  1],</span>
<span class="go">   [-9,  2,  1],</span>
<span class="go">   [-3, -4,  1]])</span>
</pre></div>
</div>
<p class="rubric"><span class="math notranslate nohighlight">\(C = A^T B^T\)</span></p>
<div class="math notranslate nohighlight">
\[C[i, k] = A[j, i] B [k, j]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">B</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[ 3,  6, -3],</span>
<span class="go">   [ 1,  8, -3],</span>
<span class="go">   [-1, 10, -3]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ji,kj-&gt;ik&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">array([[ 3,  6, -3],</span>
<span class="go">   [ 1,  8, -3],</span>
<span class="go">   [-1, 10, -3]])</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id17">Element-wise Multiplication</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p class="rubric"><span class="math notranslate nohighlight">\(C[i,j] = A[i, j] B[i,j]\)</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">*</span> <span class="n">B</span>
<span class="go">array([[  0,   1,  -4],</span>
<span class="go">   [  9,   8, -15],</span>
<span class="go">   [  0,  -1,   2]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ij-&gt;ij&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">array([[  0,   1,  -4],</span>
<span class="go">   [  9,   8, -15],</span>
<span class="go">   [  0,  -1,   2]])</span>
</pre></div>
</div>
<p>We can similarly construct element wise multiplications
with the transposes of either A or B or both.</p>
<p class="rubric"><span class="math notranslate nohighlight">\(C[i, j] = A[i,j] B[j, i]\)</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">*</span> <span class="n">B</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[ 0,  3,  0],</span>
<span class="go">   [ 3,  8, -5],</span>
<span class="go">   [ 0, -3,  2]])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ji-&gt;ij&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">array([[ 0,  3,  0],</span>
<span class="go">   [ 3,  8, -5],</span>
<span class="go">   [ 0, -3,  2]])</span>
</pre></div>
</div>
</div>
<div class="section" id="column-wise-dot-product">
<h3><a class="toc-backref" href="#id18">Column-wise Dot Product</a><a class="headerlink" href="#column-wise-dot-product" title="Permalink to this headline">¶</a></h3>
<p>Sometimes we need to compute the inner product
of each column of <span class="math notranslate nohighlight">\(A\)</span> with corresponding
column of <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>Suppose we have <span class="math notranslate nohighlight">\(n\)</span> columns in both <span class="math notranslate nohighlight">\(A\)</span>
and <span class="math notranslate nohighlight">\(B\)</span> with <span class="math notranslate nohighlight">\(m\)</span> rows each. Then
the result will be a vector of dimension <span class="math notranslate nohighlight">\(n\)</span>
such that:</p>
<div class="math notranslate nohighlight">
\[v[j] = \langle A[:, j], B[:, j] \rangle\]</div>
<p>In a way we are multiplying the matrices element wise
and then summing over each column. In Einstein notation:</p>
<div class="math notranslate nohighlight">
\[v[j] = A[i, j] B[i, j]\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;ij,ij-&gt;j&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">array([  9,   8, -17])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">B</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([  9,   8, -17])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="general-array-operations">
<h2><a class="toc-backref" href="#id19">General Array Operations</a><a class="headerlink" href="#general-array-operations" title="Permalink to this headline">¶</a></h2>
<p>Following operations work on arrays of any dimension.</p>
<p>A view of an array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">   [3, 4, 5],</span>
<span class="go">   [0, 1, 2]])</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../../zzzreferences.html" class="btn btn-neutral float-right" title="References" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Linear Algebra Computations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-Present, Carnot Research Pvt. Ltd..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>