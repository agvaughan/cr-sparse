
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Compressive Sensing Operators &#8212; cr-sparse  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/custom.js"></script>
    <script src="../../_static/js/mathconf.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Deconvolution" href="deconvolution.html" />
    <link rel="prev" title="A matrix backed linear operator" href="matrix_operator.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">cr-sparse</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=carnotresearch&repo=cr-sparse&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/index.html">CR.Sparse API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../la/index.html">Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sls/index.html">Sparse Linear Systems</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../sparse_vector_normals.html">A sparse model vector generator</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#linear-operators">Linear Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#greedy-pursuit-algorithms-for-sparse-recovery">Greedy Pursuit Algorithms for Sparse Recovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#sparse-recovery-via-l1-minimization">Sparse Recovery via L1 minimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#wavelets">Wavelets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../benchmarks/index.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fwsp/index.html">Fourier and Wavelet Representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acronyms.html">Acronyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zzzreference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Development</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Examples Gallery</a><ul>
      <li>Previous: <a href="matrix_operator.html" title="previous chapter">A matrix backed linear operator</a></li>
      <li>Next: <a href="deconvolution.html" title="next chapter">Deconvolution</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gallery-lop-cs-operators-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="compressive-sensing-operators">
<span id="gallery-lop-cs-operators"></span><span id="sphx-glr-gallery-lop-cs-operators-py"></span><h1>Compressive Sensing Operators<a class="headerlink" href="#compressive-sensing-operators" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#rademacher-sensing-operators" id="id6">Rademacher sensing operators</a></p>
<ul>
<li><p><a class="reference internal" href="#unnormalized-atoms-columns" id="id7">Unnormalized atoms / columns</a></p></li>
<li><p><a class="reference internal" href="#normalized-atoms-columns" id="id8">Normalized atoms / columns</a></p></li>
<li><p><a class="reference internal" href="#column-wise-application-on-input" id="id9">Column wise application on input</a></p></li>
<li><p><a class="reference internal" href="#row-wise-application-on-input" id="id10">Row wise application on input</a></p></li>
<li><p><a class="reference internal" href="#square-sensing-matrix" id="id11">Square sensing matrix</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#gaussian-sensing-operators" id="id12">Gaussian sensing operators</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id13">Unnormalized atoms / columns</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id14">Normalized atoms / columns</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id15">Column wise application on input</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id16">Row wise application on input</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id17">Square sensing matrix</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#random-matrix-with-orthonormal-rows" id="id18">Random matrix with orthonormal rows</a></p></li>
<li><p><a class="reference internal" href="#random-orthonormal-basis-operator" id="id19">Random orthonormal basis operator</a></p></li>
</ul>
</div>
<p>Let’s import necessary libraries</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="c1"># Random numbers</span>
<span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">random</span>
<span class="c1"># For plotting diagrams</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1">## CR-Sparse modules</span>
<span class="kn">import</span> <span class="nn">cr.sparse</span> <span class="k">as</span> <span class="nn">crs</span>
<span class="c1"># Linear operators</span>
<span class="kn">from</span> <span class="nn">cr.sparse</span> <span class="kn">import</span> <span class="n">lop</span>
<span class="c1"># Some random number seeds</span>
<span class="n">key</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.random.PRNGKey.html#jax.random.PRNGKey" title="jax.random.PRNGKey" class="sphx-glr-backref-module-jax-random sphx-glr-backref-type-py-function"><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">keys</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.random.split.html#jax.random.split" title="jax.random.split" class="sphx-glr-backref-module-jax-random sphx-glr-backref-type-py-function"><span class="n">random</span><span class="o">.</span><span class="n">split</span></a><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<section id="rademacher-sensing-operators">
<h2><a class="toc-backref" href="#id6">Rademacher sensing operators</a><a class="headerlink" href="#rademacher-sensing-operators" title="Permalink to this headline">¶</a></h2>
<p>Size of the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span>
</pre></div>
</div>
<section id="unnormalized-atoms-columns">
<h3><a class="toc-backref" href="#id7">Unnormalized atoms / columns</a><a class="headerlink" href="#unnormalized-atoms-columns" title="Permalink to this headline">¶</a></h3>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">rademacher_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <span class="n">normalize_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s print the contents of the matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.  1. -1. -1.  1. -1. -1.  1.]
 [ 1. -1. -1. -1.  1. -1.  1.  1.]
 [-1. -1. -1. -1. -1.  1. -1. -1.]
 [ 1. -1. -1.  1.  1. -1.  1. -1.]]
</pre></div>
</div>
<p>Let’s print the contents of the adjoint matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_adjoint_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.  1. -1.  1.]
 [ 1. -1. -1. -1.]
 [-1. -1. -1. -1.]
 [-1. -1. -1.  1.]
 [ 1.  1. -1.  1.]
 [-1. -1.  1. -1.]
 [-1.  1. -1.  1.]
 [ 1.  1. -1. -1.]]
</pre></div>
</div>
<p>Let’s apply the forward operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.array.html#jax.numpy.array" title="jax.numpy.array" class="sphx-glr-backref-module-jax-numpy sphx-glr-backref-type-py-function"><span class="n">jnp</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-24.  -2. -18.  16.]
</pre></div>
</div>
<p>Let’s apply the adjoint operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[ 56. -20.  28.  60.   8.  -8.  56. -24.]
</pre></div>
</div>
<p>Let’s JIT compile the trans and times functions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s verify the forward operator after JIT compile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.array.html#jax.numpy.array" title="jax.numpy.array" class="sphx-glr-backref-module-jax-numpy sphx-glr-backref-type-py-function"><span class="n">jnp</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-24.  -2. -18.  16.]
</pre></div>
</div>
<p>Let’s verify the adjoint operator after JIT compile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[ 56. -20.  28.  60.   8.  -8.  56. -24.]
</pre></div>
</div>
</section>
<section id="normalized-atoms-columns">
<h3><a class="toc-backref" href="#id8">Normalized atoms / columns</a><a class="headerlink" href="#normalized-atoms-columns" title="Permalink to this headline">¶</a></h3>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">rademacher_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <span class="n">normalize_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s print the contents of the matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-0.5  0.5 -0.5 -0.5  0.5 -0.5 -0.5  0.5]
 [ 0.5 -0.5 -0.5 -0.5  0.5 -0.5  0.5  0.5]
 [-0.5 -0.5 -0.5 -0.5 -0.5  0.5 -0.5 -0.5]
 [ 0.5 -0.5 -0.5  0.5  0.5 -0.5  0.5 -0.5]]
</pre></div>
</div>
<p>Check the column wise norms</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">crs</span><span class="o">.</span><span class="n">norms_l2_cw</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[1. 1. 1. 1. 1. 1. 1. 1.]
</pre></div>
</div>
<p>Let’s print the contents of the adjoint matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_adjoint_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-0.5  0.5 -0.5  0.5]
 [ 0.5 -0.5 -0.5 -0.5]
 [-0.5 -0.5 -0.5 -0.5]
 [-0.5 -0.5 -0.5  0.5]
 [ 0.5  0.5 -0.5  0.5]
 [-0.5 -0.5  0.5 -0.5]
 [-0.5  0.5 -0.5  0.5]
 [ 0.5  0.5 -0.5 -0.5]]
</pre></div>
</div>
<p>Let’s apply the forward operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.array.html#jax.numpy.array" title="jax.numpy.array" class="sphx-glr-backref-module-jax-numpy sphx-glr-backref-type-py-function"><span class="n">jnp</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-12.  -1.  -9.   8.]
</pre></div>
</div>
<p>Let’s apply the adjoint operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[14. -5.  7. 15.  2. -2. 14. -6.]
</pre></div>
</div>
<p>Let’s JIT compile the trans and times functions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s verify the forward operator after JIT compile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[-12.  -1.  -9.   8.]
</pre></div>
</div>
<p>Let’s verify the adjoint operator after JIT compile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[14. -5.  7. 15.  2. -2. 14. -6.]
</pre></div>
</div>
</section>
<section id="column-wise-application-on-input">
<h3><a class="toc-backref" href="#id9">Column wise application on input</a><a class="headerlink" href="#column-wise-application-on-input" title="Permalink to this headline">¶</a></h3>
<p>Number of signals</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
<p>Prepare a signal matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.random.randint.html#jax.random.randint" title="jax.random.randint" class="sphx-glr-backref-module-jax-random sphx-glr-backref-type-py-function"><span class="n">random</span><span class="o">.</span><span class="n">randint</span></a><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a><span class="p">),</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1  2  2 -4  2]
 [-3 -1 -3 -1 -5]
 [ 3 -1 -1 -3  2]
 [-3 -5 -1  1 -5]
 [ 0  3  1 -1 -5]
 [ 1  3 -3 -3 -3]
 [ 0  1 -5  0  0]
 [-2 -4  4 -1  1]]
</pre></div>
</div>
<p>Let’s apply the forward operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-2.5 -1.   5.   3.  -2.5]
 [-0.5  3.   5.   0.   4.5]
 [ 3.5  4.   0.   3.   3.5]
 [-1.5  2.   0.   2.  -1.5]]
</pre></div>
</div>
<p>Let’s apply the adjoint operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.5  1.   0.  -2.   1. ]
 [-2.  -5.   0.  -1.  -4.5]
 [ 0.5 -4.  -5.  -4.  -2. ]
 [-1.  -2.  -5.  -2.  -3.5]
 [-4.   0.   5.   1.  -1.5]
 [ 4.   0.  -5.  -1.   1.5]
 [-1.5  1.   0.  -2.   1. ]
 [-2.5 -2.   5.  -1.   0. ]]
</pre></div>
</div>
</section>
<section id="row-wise-application-on-input">
<h3><a class="toc-backref" href="#id10">Row wise application on input</a><a class="headerlink" href="#row-wise-application-on-input" title="Permalink to this headline">¶</a></h3>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">rademacher_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <span class="n">normalize_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Prepare a signal matrix with each signal along a row</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">XT</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>Let’s apply the forward operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">XT</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-2.5 -0.5  3.5 -1.5]
 [-1.   3.   4.   2. ]
 [ 5.   5.   0.   0. ]
 [ 3.   0.   3.   2. ]
 [-2.5  4.5  3.5 -1.5]]
</pre></div>
</div>
<p>Let’s apply the adjoint operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.5 -2.   0.5 -1.  -4.   4.  -1.5 -2.5]
 [ 1.  -5.  -4.  -2.   0.   0.   1.  -2. ]
 [ 0.   0.  -5.  -5.   5.  -5.   0.   5. ]
 [-2.  -1.  -4.  -2.   1.  -1.  -2.  -1. ]
 [ 1.  -4.5 -2.  -3.5 -1.5  1.5  1.   0. ]]
</pre></div>
</div>
</section>
<section id="square-sensing-matrix">
<h3><a class="toc-backref" href="#id11">Square sensing matrix</a><a class="headerlink" href="#square-sensing-matrix" title="Permalink to this headline">¶</a></h3>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">rademacher_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <span class="n">normalize_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s print the contents of the matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 1.  1. -1. -1. -1. -1.  1.  1.]
 [-1.  1.  1.  1. -1. -1. -1. -1.]
 [-1. -1.  1.  1.  1. -1.  1. -1.]
 [ 1. -1.  1. -1.  1.  1.  1. -1.]
 [-1.  1. -1.  1.  1.  1. -1. -1.]
 [-1.  1. -1.  1.  1. -1.  1.  1.]
 [ 1. -1.  1. -1. -1. -1. -1.  1.]
 [-1. -1.  1. -1.  1. -1.  1. -1.]]
</pre></div>
</div>
</section>
</section>
<section id="gaussian-sensing-operators">
<h2><a class="toc-backref" href="#id12">Gaussian sensing operators</a><a class="headerlink" href="#gaussian-sensing-operators" title="Permalink to this headline">¶</a></h2>
<section id="id1">
<h3><a class="toc-backref" href="#id13">Unnormalized atoms / columns</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">gaussian_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <span class="n">normalize_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s print the contents of the matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.11122803 -0.16993073  1.129604    0.64738166 -0.4244191   0.5942929
   0.47133887 -0.06662087]
 [-0.5737654   0.8247352   0.13019586  0.19609931 -0.21847607  0.0974834
  -0.26925555 -0.35676587]
 [ 0.15494195  0.19627537  0.31454134  0.35439804  1.3098817  -0.47109568
   0.08758704  0.2653513 ]
 [-0.10465632  0.57652146  0.01025868 -0.50620335 -0.07852525  0.371066
  -0.6290615   0.21203126]]
</pre></div>
</div>
<p>Let’s print the contents of the adjoint matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_adjoint_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.11122803 -0.5737654   0.15494195 -0.10465632]
 [-0.16993073  0.8247352   0.19627537  0.57652146]
 [ 1.129604    0.13019586  0.31454134  0.01025868]
 [ 0.64738166  0.19609931  0.35439804 -0.50620335]
 [-0.4244191  -0.21847607  1.3098817  -0.07852525]
 [ 0.5942929   0.0974834  -0.47109568  0.371066  ]
 [ 0.47133887 -0.26925555  0.08758704 -0.6290615 ]
 [-0.06662087 -0.35676587  0.2653513   0.21203126]]
</pre></div>
</div>
<p>Let’s apply the forward operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.array.html#jax.numpy.array" title="jax.numpy.array" class="sphx-glr-backref-module-jax-numpy sphx-glr-backref-type-py-function"><span class="n">jnp</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[13.605416  -2.7819417  6.103368  -8.876923 ]
</pre></div>
</div>
<p>Let’s apply the adjoint operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[ 4.984179   -8.526139   16.83523    14.918911    3.5251415   1.6452142
 13.280521   -0.17655145]
</pre></div>
</div>
<p>Let’s JIT compile the trans and times functions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s verify the forward operator after JIT compile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.array.html#jax.numpy.array" title="jax.numpy.array" class="sphx-glr-backref-module-jax-numpy sphx-glr-backref-type-py-function"><span class="n">jnp</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[13.605416  -2.7819417  6.103368  -8.876923 ]
</pre></div>
</div>
<p>Let’s verify the adjoint operator after JIT compile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[ 4.984179   -8.526139   16.83523    14.918911    3.5251415   1.6452142
 13.280521   -0.17655145]
</pre></div>
</div>
</section>
<section id="id2">
<h3><a class="toc-backref" href="#id14">Normalized atoms / columns</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">gaussian_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <span class="n">normalize_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s print the contents of the matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.18126318 -0.16351853  0.9574299   0.7066046  -0.30394688  0.69926095
   0.5641445  -0.13402437]
 [-0.935039    0.7936145   0.11035142  0.21403863 -0.1564612   0.11470159
  -0.3222714  -0.71772283]
 [ 0.25250173  0.18886907  0.26659897  0.38681865  0.9380691  -0.5543038
   0.10483275  0.5338198 ]
 [-0.17055357  0.5547669   0.00869506 -0.5525112  -0.0562357   0.43660623
  -0.7529224   0.42655337]]
</pre></div>
</div>
<p>Check the column wise norms</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">crs</span><span class="o">.</span><span class="n">norms_l2_cw</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.99999994 1.         1.         0.99999994 0.99999994 1.
 0.99999994 0.99999994]
</pre></div>
</div>
<p>Let’s print the contents of the adjoint matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_adjoint_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.18126318 -0.935039    0.25250173 -0.17055357]
 [-0.16351853  0.7936145   0.18886907  0.5547669 ]
 [ 0.9574299   0.11035142  0.26659897  0.00869506]
 [ 0.7066046   0.21403863  0.38681865 -0.5525112 ]
 [-0.30394688 -0.1564612   0.9380691  -0.0562357 ]
 [ 0.69926095  0.11470159 -0.5543038   0.43660623]
 [ 0.5641445  -0.3222714   0.10483275 -0.7529224 ]
 [-0.13402437 -0.71772283  0.5338198   0.42655337]]
</pre></div>
</div>
<p>Let’s apply the forward operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.array.html#jax.numpy.array" title="jax.numpy.array" class="sphx-glr-backref-module-jax-numpy sphx-glr-backref-type-py-function"><span class="n">jnp</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[ 14.662902   -3.538056    5.4034195 -10.189851 ]
</pre></div>
</div>
<p>Let’s apply the adjoint operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[ 9.068353   -9.837962   15.000216   17.323744    1.7386395   2.4032853
 17.650831   -0.88790536]
</pre></div>
</div>
<p>Let’s JIT compile the trans and times functions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s verify the forward operator after JIT compile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[ 14.662902   -3.538056    5.4034195 -10.189851 ]
</pre></div>
</div>
<p>Let’s verify the adjoint operator after JIT compile</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[ 9.068353   -9.837962   15.000216   17.323744    1.7386395   2.4032853
 17.650831   -0.88790536]
</pre></div>
</div>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id15">Column wise application on input</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Number of signals</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
<p>Prepare a signal matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.random.randint.html#jax.random.randint" title="jax.random.randint" class="sphx-glr-backref-module-jax-random sphx-glr-backref-type-py-function"><span class="n">random</span><span class="o">.</span><span class="n">randint</span></a><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a><span class="p">),</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1  2  2 -4  2]
 [-3 -1 -3 -1 -5]
 [ 3 -1 -1 -3  2]
 [-3 -5 -1  1 -5]
 [ 0  3  1 -1 -5]
 [ 1  3 -3 -3 -3]
 [ 0  1 -5  0  0]
 [-2 -4  4 -1  1]]
</pre></div>
</div>
<p>Let’s apply the forward operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 2.0290778  -1.6782236  -6.5695024  -4.387031   -1.150117  ]
 [-0.20671892 -1.4208958  -6.335412    3.359605   -6.9671626 ]
 [-2.8017113  -2.7637084   3.4970746  -1.4208317  -4.3338513 ]
 [-0.22662884  0.53996277  2.6431794  -2.1312852  -0.9370823 ]]
</pre></div>
</div>
<p>Let’s apply the adjoint operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.07697286e-01  2.34459132e-01  5.16526222e+00 -3.93183327e+00
   5.37161255e+00]
 [-1.15072978e+00 -1.07564843e+00 -1.82680178e+00  1.93287456e+00
  -6.67956877e+00]
 [ 1.17098403e+00 -2.49568629e+00 -6.03366089e+00 -4.22686148e+00
  -3.03354096e+00]
 [ 4.30970579e-01 -2.85735655e+00 -6.10571623e+00 -1.75285637e+00
  -3.46258569e+00]
 [-3.19984245e+00 -1.89050877e+00  6.11988258e+00 -4.05207336e-01
  -2.57308960e+00]
 [ 2.84919572e+00  4.31189954e-01 -6.10489130e+00 -2.82528734e+00
   3.89757782e-01]
 [ 1.08823550e+00 -1.18512368e+00 -3.28792763e+00 -2.10188103e+00
   1.84770596e+00]
 [-1.71585727e+00 -2.67033116e-04  8.42180729e+00 -3.49087119e+00
   2.44142413e+00]]
</pre></div>
</div>
</section>
<section id="id4">
<h3><a class="toc-backref" href="#id16">Row wise application on input</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">gaussian_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <span class="n">normalize_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Prepare a signal matrix with each signal along a row</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">XT</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>Let’s apply the forward operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">XT</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 2.0290778  -0.20671892 -2.8017113  -0.22662884]
 [-1.6782236  -1.4208958  -2.7637084   0.53996277]
 [-6.5695024  -6.335412    3.4970746   2.6431794 ]
 [-4.387031    3.359605   -1.4208317  -2.1312852 ]
 [-1.150117   -6.9671626  -4.3338513  -0.9370823 ]]
</pre></div>
</div>
<p>Let’s apply the adjoint operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.07697286e-01 -1.15072978e+00  1.17098403e+00  4.30970579e-01
  -3.19984245e+00  2.84919572e+00  1.08823550e+00 -1.71585727e+00]
 [ 2.34459132e-01 -1.07564843e+00 -2.49568629e+00 -2.85735655e+00
  -1.89050877e+00  4.31189954e-01 -1.18512368e+00 -2.67033116e-04]
 [ 5.16526222e+00 -1.82680178e+00 -6.03366089e+00 -6.10571623e+00
   6.11988258e+00 -6.10489130e+00 -3.28792763e+00  8.42180729e+00]
 [-3.93183327e+00  1.93287456e+00 -4.22686148e+00 -1.75285637e+00
  -4.05207336e-01 -2.82528734e+00 -2.10188103e+00 -3.49087119e+00]
 [ 5.37161255e+00 -6.67956877e+00 -3.03354096e+00 -3.46258569e+00
  -2.57308960e+00  3.89757782e-01  1.84770596e+00  2.44142413e+00]]
</pre></div>
</div>
</section>
<section id="id5">
<h3><a class="toc-backref" href="#id17">Square sensing matrix</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">gaussian_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">,</span> <span class="n">normalize_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s print the contents of the matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-0.53925216 -0.3882511   0.25014424  0.3166799   0.14359106  0.28305036
  -0.07129304 -0.98230976]
 [ 0.48235154 -0.5217401  -0.2262006  -0.26431024  0.01718562  0.42955163
   0.17562762  0.27974603]
 [ 0.06246139  0.3475518  -0.3206163  -0.45171177 -0.16332498  0.07702307
  -0.5367819   0.07000328]
 [-0.6867531   0.2754768  -0.2697064   0.7436678  -0.41739193 -0.13276188
  -0.55814624  0.0482984 ]
 [ 0.09936127 -0.4716727   0.23744273 -0.04883419 -0.03434075 -0.17994446
   0.52424425  0.8963415 ]
 [ 0.5597964  -0.31409547  0.09103467 -0.19633469 -0.55392534  0.03580119
  -0.2882085  -0.1999811 ]
 [-0.30475712  0.5132278  -0.29558337  0.15022355  0.3522544   0.6384667
   0.3234877  -0.24913491]
 [ 0.17091885  0.16325223 -1.1366054   0.08454105 -0.1228935   0.02398683
  -0.16997333  0.14779326]]
</pre></div>
</div>
</section>
</section>
<section id="random-matrix-with-orthonormal-rows">
<h2><a class="toc-backref" href="#id18">Random matrix with orthonormal rows</a><a class="headerlink" href="#random-matrix-with-orthonormal-rows" title="Permalink to this headline">¶</a></h2>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">random_orthonormal_rows_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">m</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Let’s print the contents of the matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-0.07292485  0.27826375  0.37618032  0.14324042 -0.10158526 -0.8588034
   0.06861627  0.05148385]
 [ 0.10594717 -0.3474947  -0.4921379   0.03977736 -0.30663046 -0.357414
  -0.5367419  -0.33820367]
 [-0.78170216 -0.33252037 -0.0975585   0.17760432 -0.20400117 -0.0035249
   0.00375868  0.4423434 ]
 [ 0.24007519 -0.20002364  0.31128162 -0.25678173  0.24578355 -0.03488652
  -0.60000247  0.56381875]]
</pre></div>
</div>
<p>Check the row wise norms</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">crs</span><span class="o">.</span><span class="n">norms_l2_rw</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[0.9999999 1.        0.9999999 0.9999999]
</pre></div>
</div>
<p>Let’s apply the forward operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.0248178  -4.5349813   0.8376172   1.6546468   1.6348104 ]
 [-0.34021556 -0.32342052  3.8032455   3.1569734   3.0333958 ]
 [ 0.06556308 -4.40954     0.9112647   3.701841    0.48898292]
 [ 0.90166175 -0.56978536  6.6314516  -2.6558464   2.8263009 ]]
</pre></div>
</div>
<p>Let’s apply the adjoint operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.20390563  3.6066031   1.2215693  -3.3175325   0.4984471 ]
 [-0.3691013   0.43069848 -2.7179902  -1.3363088  -1.3271042 ]
 [ 0.05619119 -1.2939788   0.41872117 -2.119083   -0.0457945 ]
 [-0.38021418 -1.2993004  -1.2697273   1.7020242  -0.2840655 ]
 [ 0.41666552  1.3193654   0.19272217 -2.5440552  -0.501299  ]
 [ 0.97002786  4.0456734  -2.3132422  -2.469758   -2.5884824 ]
 [-0.42846408  0.18771842 -5.959349    0.02648418 -3.2099257 ]
 [ 0.5996758  -2.395883    2.898881   -0.8424433   0.86808056]]
</pre></div>
</div>
<p>The frame operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
</pre></div>
</div>
<p>Check that it’s close to identity matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.round.html#jax.numpy.round" title="jax.numpy.round" class="sphx-glr-backref-module-jax-numpy sphx-glr-backref-type-py-function"><span class="n">jnp</span><span class="o">.</span><span class="n">round</span></a><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">F</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]]
</pre></div>
</div>
</section>
<section id="random-orthonormal-basis-operator">
<h2><a class="toc-backref" href="#id19">Random orthonormal basis operator</a><a class="headerlink" href="#random-orthonormal-basis-operator" title="Permalink to this headline">¶</a></h2>
<p>Construct the operator wrapping the sensing matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Phi</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">random_onb_dict</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Let’s print the contents of the matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-0.448704   -0.5938689  -0.17305267  0.3457046  -0.02234844 -0.2556191
   0.24217391  0.41477355]
 [ 0.40135783 -0.33225274 -0.37034228  0.13488609  0.16407289 -0.40697533
   0.09995174 -0.6087966 ]
 [ 0.05197322  0.36943048 -0.05747127  0.73125654 -0.5508195  -0.07972308
  -0.08231382 -0.07904251]
 [-0.57143736  0.00868553 -0.28070897 -0.42135626 -0.49334717 -0.08988534
  -0.10255462 -0.39377302]
 [ 0.08267709 -0.430307   -0.04261965  0.10346383 -0.04977352  0.2478968
  -0.8551025   0.01867646]
 [ 0.46579853 -0.0960511   0.06027021 -0.3657182  -0.49611133 -0.46696046
  -0.05138361  0.41183102]
 [-0.25358403  0.39233106 -0.04585971  0.02340384  0.41380572 -0.6423371
  -0.42444575  0.12302164]
 [ 0.14221913  0.22816646 -0.8621179  -0.07081565  0.07712521  0.24998598
   0.00859012  0.3330717 ]]
</pre></div>
</div>
<p>Check the row wise norms</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">crs</span><span class="o">.</span><span class="n">norms_l2_rw</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[1.0000001 1.0000001 1.0000001 1.        1.        1.        1.
 1.       ]
</pre></div>
</div>
<p>Check the column wise norms</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">crs</span><span class="o">.</span><span class="n">norms_l2_cw</span><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">Phi</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[1.         1.         1.0000001  1.0000001  1.0000001  1.
 1.         0.99999994]
</pre></div>
</div>
<p>Let’s apply the forward operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-0.41112733 -4.1098323   1.9042804   3.6279798   1.2906815 ]
 [-0.10966682  2.637311    0.48498416  1.6383841   0.84062934]
 [-3.4480863  -5.522067   -1.8943813   1.1953783  -2.6002073 ]
 [ 1.6649833   0.9587699  -1.7528762   3.8546107   2.7016797 ]
 [ 0.9805374  -0.21447678  4.9521856  -0.38167197  1.2381845 ]
 [-0.19030249 -1.791954    4.3342104  -0.82851005  7.6542525 ]
 [-2.0195801  -2.5727851   3.293427    2.173172   -2.6965578 ]
 [-3.6167827   0.93010473  1.1493759   0.5583402  -3.029064  ]]
</pre></div>
</div>
<p>Let’s apply the adjoint operator column wise</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">Phi</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[-1.0000000e+00  2.0000012e+00  1.9999996e+00 -4.0000010e+00
   1.9999996e+00]
 [-3.0000000e+00 -9.9999946e-01 -3.0000000e+00 -1.0000005e+00
  -5.0000005e+00]
 [ 3.0000017e+00 -9.9999869e-01 -1.0000002e+00 -3.0000019e+00
   2.0000010e+00]
 [-3.0000021e+00 -5.0000019e+00 -9.9999976e-01  1.0000014e+00
  -5.0000014e+00]
 [ 6.3378997e-07  3.0000007e+00  9.9999988e-01 -1.0000007e+00
  -5.0000000e+00]
 [ 1.0000002e+00  3.0000000e+00 -2.9999998e+00 -3.0000007e+00
  -2.9999990e+00]
 [-1.8935772e-07  9.9999988e-01 -5.0000000e+00  1.2755389e-07
  -3.1231309e-07]
 [-1.9999996e+00 -4.0000000e+00  3.9999995e+00 -9.9999988e-01
   9.9999988e-01]]
</pre></div>
</div>
<p>The gram operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">gram</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
</pre></div>
</div>
<p>Check that it’s close to identity matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.round.html#jax.numpy.round" title="jax.numpy.round" class="sphx-glr-backref-module-jax-numpy sphx-glr-backref-type-py-function"><span class="n">jnp</span><span class="o">.</span><span class="n">round</span></a><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1.]]
</pre></div>
</div>
<p>The frame operator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="n">lop</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
</pre></div>
</div>
<p>Check that it’s close to identity matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.round.html#jax.numpy.round" title="jax.numpy.round" class="sphx-glr-backref-module-jax-numpy sphx-glr-backref-type-py-function"><span class="n">jnp</span><span class="o">.</span><span class="n">round</span></a><span class="p">(</span><span class="n">lop</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span><span class="n">F</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1.]]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  3.776 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-lop-cs-operators-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/af0771c1d9d7839469d9f60430dda282/cs_operators.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">cs_operators.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4f5a637efbfa2f1d0d5429f804963bb6/cs_operators.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">cs_operators.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2021, CR-Sparse Development Team.
      
      |
      <a href="../../_sources/gallery/lop/cs_operators.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/carnotresearch/cr-sparse" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>